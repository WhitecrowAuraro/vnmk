<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.0.4/firebase.js"></script>
<script src="https://cdn.firebase.com/libs/firebaseui/3.1.1/firebaseui.js"></script>
<script src="/static/openpgp.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/3.1.1/firebaseui.css" />

<script>
var sessionTimeout={{ session_timeout }};
firebase.initializeApp({
    apiKey: "{{ firebase_api_key }}",
    authDomain: "{{ firebase_project_id }}.firebaseapp.com",
    databaseURL: "https://{{ firebase_project_id }}.firebaseio.com",
    projectId: "{{ firebase_project_id }}",
});
</script>
<script src="/static/main.js"></script>
<link type="text/css" rel="stylesheet" href="/static/main.css" />

</head>
<body class="status-not-authenticated">

<h1> NeoAtlantis Terminal Dogma Access </h1>
<hr />

<div class="not-authenticated">

    <h3>Please authenticate yourself by one of following providers...</h3>
    <div id="telegram">
        <script 
            async src="https://telegram.org/js/telegram-widget.js?4"
            data-telegram-login="neoatlantis_terminaldogma_bot" data-size="large"
            data-onauth="onTelegramAuth(user)"></script>
    </div>
    <div id="firebase">
        <div id="firebaseui-auth-container"></div>
    </div>

    <h3>...and input a correct access code:</h3>
    <div>
        <input type="password" id="accesscode" />
    </div>

    <h3>within <span id="countdown"></span> seconds.</h3>
    <div>
    This countdown can only be stopped by a successful authentication.
    When otherwise timed out, access will be denied permanently.
    </div>

    <hr />
    <div id="error"></div>
    <div>
        <button type="button" id="login" disabled autocomplete="off" onclick="onLogin()">
            <strong>Request Access</strong>
            <div>
                <br />
                You will have only one chance requesting this access. <br />
                Any failed attempt results in irrevocable access denial.
            </div>
        </button>
    </div>

</div>

<div class="authenticated">
    <pre id="credential"></pre>

    <div id="decrypt-prompt">
        <hr />
        Decrypt with password:
        <input type="password" id="password" />
        <button id="decrypt" onclick="tryDecrypt();">Decrypt</button>
    </div>
</div>

</body>
</html>
